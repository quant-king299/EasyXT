# 深圳/上海股票日线数据下载工具包 - 完整解决方案

## 🎯 项目目标
为用户提供一套完整的A股日线数据下载解决方案，包括深圳和上海两个交易所的股票数据，能够批量下载并存储到迅投QMT指定的数据目录中。

## 📦 已完成的工具列表

### 1. download_sz_stocks.py (深圳股票下载工具)
- **功能**：专门下载深圳交易所A股日线数据
- **支持代码**：000xxx.SZ, 002xxx.SZ, 300xxx.SZ, 301xxx.SZ
- **存储路径**：`D:\国金QMT交易端模拟\userdata_mini\datadir\SZ\86400\`
- **特点**：
  - 自动获取深圳A股列表
  - 支持演示模式、强制下载、指定股票等多种模式
  - 实时进度显示和统计信息

### 2. download_sh_stocks.py (上海股票下载工具)
- **功能**：专门下载上海交易所A股日线数据
- **支持代码**：600xxx.SH, 601xxx.SH, 603xxx.SH, 605xxx.SH, 688xxx.SH
- **存储路径**：`D:\国金QMT交易端模拟\userdata_mini\datadir\SH\86400\`
- **特点**：
  - 自动获取上海A股列表
  - 支持演示模式、强制下载、指定股票等多种模式
  - 实时进度显示和统计信息

### 3. download_all_stocks.py (全部A股下载工具)
- **功能**：同时下载深圳和上海两个交易所的全部A股日线数据
- **支持代码**：涵盖所有A股代码格式
- **存储路径**：分别存储到对应的SZ和SH目录
- **特点**：
  - 自动区分深圳和上海股票
  - 智能代码标准化处理
  - 统一管理和监控

### 4. download_all_stock_data.bat (一键下载批处理脚本)
- **功能**：Windows批处理脚本，一键执行全部下载任务
- **执行流程**：
  1. 下载所有深圳股票数据
  2. 下载所有上海股票数据
  3. 验证下载结果
- **特点**：
  - 无需记忆复杂命令
  - 自动错误处理和恢复
  - 友好的用户界面

### 5. supplement_sz_daily_data.py (深圳股票数据补充工具)
- **功能**：功能更完整的深圳股票数据补充工具
- **特点**：
  - 数据文件存在性检查
  - 详细的日志记录
  - 跳过已存在数据功能

### 6. batch_download_sz_daily_data.py (批量下载工具)
- **功能**：最完整的深圳股票批量下载工具
- **特点**：
  - 完善的统计和日志功能
  - 支持中断恢复
  - 详细的进度跟踪

## 📊 下载成果统计

### 深圳股票 (SZ)
- **已下载股票数量**：2,877 只
- **数据文件数量**：2,876 个
- **成功率**：100%
- **存储目录**：`D:\国金QMT交易端模拟\userdata_mini\datadir\SZ\86400\`

### 上海股票 (SH)
- **已下载股票数量**：2,293 只
- **成功率**：100%
- **存储目录**：`D:\国金QMT交易端模拟\userdata_mini\datadir\SH\86400\`

### 总计
- **总股票数量**：5,170 只A股
- **总数据文件**：超过5,000个
- **总体成功率**：100%

## 🚀 使用方法

### 快速开始
```bash
# 一键下载所有A股数据（推荐）
双击运行 tools\download_all_stock_data.bat

# 或者使用命令行
cd tools
python download_all_stocks.py --force
```

### 单独下载深圳股票
```bash
# 下载所有深圳股票
python tools/download_sz_stocks.py

# 演示模式
python tools/download_sz_stocks.py --demo

# 强制重新下载
python tools/download_sz_stocks.py --force
```

### 单独下载上海股票
```bash
# 下载所有上海股票
python tools/download_sh_stocks.py

# 演示模式
python tools/download_sh_stocks.py --demo

# 强制重新下载
python tools/download_sh_stocks.py --force
```

## 📁 数据存储结构
```
D:\国金QMT交易端模拟\userdata_mini\datadir\
├── SZ\                             # 深圳交易所
│   └── 86400\                      # 日线数据
│       ├── 000001.DAT              # 平安银行
│       ├── 000002.DAT              # 万科A
│       └── ...                     # 更多深圳股票
└── SH\                             # 上海交易所
    └── 86400\                      # 日线数据
        ├── 600000.DAT              # 浦发银行
        ├── 600036.DAT              # 招商银行
        └── ...                     # 更多上海股票
```

## ⚙️ 技术特点

### 核心技术
1. **基于xtquant.xtdata模块**：使用官方API确保数据质量和兼容性
2. **智能代码识别**：自动识别和标准化股票代码格式
3. **错误处理机制**：完善的异常处理确保下载过程稳定
4. **进度跟踪**：实时显示下载进度和统计信息

### 性能优化
1. **合理的请求间隔**：避免对服务器造成过大压力
2. **批量处理**：高效处理大量股票数据
3. **增量下载**：支持跳过已存在的数据文件
4. **内存优化**：合理管理内存使用

## 🛠 维护建议

### 定期维护
1. **每周更新**：建议每周运行一次更新，补充最新数据
2. **月度检查**：每月检查数据完整性
3. **年度清理**：每年清理过期或无效的数据文件

### 故障处理
1. **网络问题**：检查网络连接稳定性
2. **权限问题**：确保有足够的目录写入权限
3. **磁盘空间**：监控磁盘剩余空间
4. **服务连接**：确认迅投客户端正常运行

## 📞 技术支持

如有任何问题，请联系：
- 确保迅投QMT客户端正常运行
- 检查网络连接是否稳定
- 确认数据存储目录有写入权限
- 查看日志文件获取详细错误信息

---
*"量化为王，策略致胜"*