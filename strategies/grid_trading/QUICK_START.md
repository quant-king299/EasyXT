# 国债ETF高频网格交易 - 快速开始

## 📖 什么是国债ETF网格交易？

国债ETF（如511090.SH、511130.SH）具有以下特点：
- ✅ **波动小且稳定**：日波动0.2%-0.5%，非常适合网格交易
- ✅ **流动性好**：买卖价差小，成交容易
- ✅ **风险可控**：国债违约风险极低
- ✅ **适合高频**：可以在小幅波动中反复获利

### 网格交易原理

```
价格 102.00 ━━━━━━━━━━━━━━━━━━━━ 卖出100股 (+0.15%)
           ↗
价格 101.85 ━━━━━━━━━━━━━━━━━━━━ 基准价
           ↘
价格 101.70 ━━━━━━━━━━━━━━━━━━━━ 买入100股 (-0.15%)
```

**每次价格波动0.15%，就进行一次买卖，获取差价收益**

## 🚀 快速开始（3步）

### 第1步：修改配置文件

打开 `bond_etf_config.json`，修改以下参数：

```json
{
  "账户ID": "39020958",        // 改成你的QMT账户ID
  "是否测试": false,            // 实盘改为false
  "单次交易数量": 100,          // 每次交易100股
  "最大持仓数量": 500,          // 最大持仓500股
  "买入涨跌幅": -0.15,         // 下跌0.15%买入
  "卖出涨跌幅": 0.15           // 上涨0.15%卖出
}
```

### 第2步：运行测试脚本

```bash
cd strategies/grid_trading
python test_bond_etf_grid.py
```

### 第3步：监控运行

脚本会显示：
- 📊 实时行情（最新价、涨跌幅、持仓）
- 📈 交易统计（买入/卖出次数、收益）
- 📝 交易日志（自动保存到logs目录）

按 `Ctrl+C` 停止测试

## ⚙️ 参数说明

### 核心参数

| 参数 | 说明 | 推荐值（国债ETF） | 备注 |
|------|------|-----------------|------|
| **买入涨跌幅** | 下跌多少百分比买入 | -0.10% ~ -0.20% | 波动小设小点 |
| **卖出涨跌幅** | 上涨多少百分比卖出 | 0.10% ~ 0.20% | 与买入对称 |
| **单次交易数量** | 每次交易股数 | 100-500股 | 根据资金调整 |
| **最大持仓数量** | 单个标的最大持仓 | 500-2000股 | 不要超过资金30% |
| **价格模式** | 5=最新价，4=卖一，6=买一 | 5 | 最新价最合理 |

### 时间控制参数

| 参数 | 说明 | 推荐值 |
|------|------|--------|
| **交易时间段** | 8=工作日，0-6=周日到周六 | 8 |
| **交易开始时间** | 几点开始交易 | 9 |
| **交易结束时间** | 几点结束交易 | 15 |
| **是否参加集合竞价** | 是否9:15-9:25交易 | false |

### 监控参数

| 参数 | 说明 | 推荐值 |
|------|------|--------|
| **监控间隔** | 检查行情的间隔（秒） | 3-5 |
| **统计周期** | 打印统计的间隔（秒） | 60 |

## 📊 收益估算

### 理论收益计算

假设：
- 网格间距：0.15%
- 单次交易：100股
- 价格：100元
- 每天交易：20次

```
单次收益 = 100股 × 100元 × 0.15% = 15元
日收益 = 15元 × 20次 = 300元
月收益 = 300元 × 22天 = 6600元
年化收益 = 6600元 × 12 = 79200元

实际手续费：15 × 0.0001 × 2 = 0.003元/次（可忽略）
```

### 实际收益因素

⚠️ **实际收益取决于**：
1. **市场波动**：波动越大，交易越频繁
2. **资金量**：资金越多，单次收益越高
3. **参数设置**：网格间距要合理
4. **滑点成本**：实际成交价可能有偏差

## 🎯 使用场景推荐

### 保守型（新手）

```json
{
  "买入涨跌幅": -0.20,
  "卖出涨跌幅": 0.20,
  "单次交易数量": 100,
  "最大持仓数量": 300
}
```

**特点**：
- ✅ 交易频率低
- ✅ 资金占用少
- ✅ 风险可控

### 稳健型（推荐）

```json
{
  "买入涨跌幅": -0.15,
  "卖出涨跌幅": 0.15,
  "单次交易数量": 200,
  "最大持仓数量": 500
}
```

**特点**：
- ✅ 交易频率适中
- ✅ 收益风险平衡
- ✅ 适合长期运行

### 激进型（高资金）

```json
{
  "买入涨跌幅": -0.10,
  "卖出涨跌幅": 0.10,
  "单次交易数量": 500,
  "最大持仓数量": 2000
}
```

**特点**：
- ✅ 交易频率高
- ✅ 收益潜力大
- ⚠️ 需要较大资金

## ⚠️ 风险提示

### 主要风险

1. **单边行情风险**
   - 持续上涨：错过上涨行情，收益不如持有
   - 持续下跌：持续买入，可能短期亏损

2. **资金占用风险**
   - 单边下跌时需要不断买入
   - 要预留足够资金应对

3. **手续费风险**
   - 虽然单次很低，但累积起来也不少
   - 网格间距不要设置太小（不要<0.1%）

### 风险控制建议

✅ **仓位控制**：
- 单个标的不超过账户资金30%
- 保留至少50%现金应对单边行情

✅ **设置止损**：
- 如果持仓达到上限，停止买入
- 如果亏损超过5%，暂停策略

✅ **定期评估**：
- 每周查看交易记录
- 如果表现不佳，调整参数或暂停

✅ **选择合适时机**：
- 避开加息、降准等重大消息
- 震荡市效果最好，单边市要谨慎

## 📞 常见问题

### Q1: 没有交易信号怎么办？

**A**: 检查以下几点：
1. 是否在交易时间内
2. 网格阈值是否设置太小
3. 是否已经达到持仓上限
4. 日志文件中的上次触发价格是否正确

### Q2: 首次运行怎么开始？

**A**:
1. 设置 `is_test: true` 测试运行
2. 观察日志输出，检查参数是否合理
3. 确认无误后，改为 `is_test: false`
4. 小仓位（100股/次）开始实盘
5. 观察1-2天，确认稳定后再加大仓位

### Q3: 如何查看交易记录？

**A**: 交易日志保存在 `logs/` 目录：
```python
import pandas as pd
df = pd.read_json('logs/bond_etf_grid_20250122.json')
print(df)
```

### Q4: 可以同时交易多个国债ETF吗？

**A**: 可以！在 `股票池` 中添加多个：
```json
{
  "股票池": ["511090.SH", "511130.SH", "511280.SH"],
  "股票名称": ["30年国债", "30年国债", "5年国债"]
}
```

### Q5: 适合长期运行吗？

**A**: 非常适合！
- ✅ 国债ETF波动稳定
- ✅ 网格交易适合长期震荡
- ✅ 可以7×24小时运行（交易时间）
- ✅ 只需要定期检查和调整

## 📈 监控和管理

### 实时监控指标

运行时关注：
1. **交易频率**：每天10-30次为正常
2. **持仓情况**：不要超过最大持仓的80%
3. **收益情况**：记录每日盈亏
4. **资金占用**：确保有足够现金

### 定期维护

**每天**：
- 查看交易日志
- 统计当天收益
- 检查持仓情况

**每周**：
- 分析交易记录
- 评估策略表现
- 调整参数（如需要）

**每月**：
- 计算月度收益
- 对比基准收益
- 决定是否继续运行

## 🎓 进阶技巧

### 动态调整参数

根据市场情况调整：
- **波动大时**：增大网格间距（0.2%-0.3%）
- **波动小时**：减小网格间距（0.1%-0.15%）
- **单边上涨**：暂停买入，只卖出
- **单边下跌**：暂停策略，等企稳

### 多策略组合

可以同时运行多个参数：
```python
# 保守策略（持仓小）
params1 = {..., "单次交易数量": 100}

# 激进策略（持仓大）
params2 = {..., "单次交易数量": 300}
```

### 对冲策略

同时做多做空：
```
买入511090.SH（做多国债）
买入511010.SH（做空国债）
```

## 📞 技术支持

- **Issues**: 提交问题和建议
- **文档**: 查看完整README.md
- **社区**: 加入量化交流群

## 📄 更新日志

### v1.0 (2025-01-22)
- ✨ 首次发布国债ETF高频网格策略
- ✨ 可视化测试脚本
- ✨ 自动配置文件管理
- ✨ 实时监控和统计

---

**免责声明**：本策略仅供学习研究，实盘交易风险自负。
投资有风险，入市需谨慎！
